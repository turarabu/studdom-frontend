{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\EditUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\EditUser.vue","mtime":1576385377287},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQnV0dG9uIGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9CdXR0b24udnVlJw0KDQppbXBvcnQgSW5wdXRUZXh0IGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9JbnB1dC9UZXh0LnZ1ZScNCmltcG9ydCBJbnB1dEZpbGUgZnJvbSAnOnNyYy9jb21wb25lbnRzL1VJL0lucHV0L0ZpbGUudnVlJw0KaW1wb3J0IFNlbGVjdCBmcm9tICc6c3JjL2NvbXBvbmVudHMvVUkvSW5wdXQvU2VsZWN0LnZ1ZScNCg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIHByb3BzOiBbJ2lkJywgJ2RhdGEnXSwNCiAgICBjb21wb25lbnRzOiB7IElucHV0VGV4dCwgSW5wdXRGaWxlLCBTZWxlY3QsIEJ1dHRvbiB9LA0KICAgIGNvbXB1dGVkOiB7IGNpdGllcyB9LA0KICAgIG1ldGhvZHM6IHsgZ2V0QXZhdGFyLCBzYXZlLCBjYW5jZWwgfSwNCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB1c2VyVHlwZXM6IHsNCiAgICAgICAgICAgICAgICBhZG1pbjogJ9CQ0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGAJywNCiAgICAgICAgICAgICAgICBtYW5hZ2VyOiAn0KPQv9GA0LDQstC70Y/RjtGJ0LjQuScNCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIHVzZXI6IHRoaXMuZGF0YQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBjaXRpZXMgKCkgew0KICAgIHZhciBsaXN0ID0ge30NCg0KICAgIHRoaXMuJHN0b3JlLnN0YXRlLmNpdGllcy5mb3JFYWNoKGNpdHkgPT4gew0KICAgICAgICBsaXN0W2NpdHkuY29kZV0gPSBjaXR5Lm5hbWUNCiAgICB9KQ0KDQogICAgcmV0dXJuIGxpc3QNCn0NCg0KZnVuY3Rpb24gZ2V0QXZhdGFyIChhdmF0YXIpIHsNCiAgICBpZiAoIGF2YXRhciA9PSB1bmRlZmluZWQgfHwgYXZhdGFyID09IGZhbHNlICkNCiAgICAgICAgcmV0dXJuICcvaW1hZ2VzL2F2YXRhci5wbmcnDQogICAgDQogICAgZWxzZSByZXR1cm4gJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwgJyArIGF2YXRhcg0KfQ0KDQphc3luYyBmdW5jdGlvbiBzYXZlIChldmVudCkgew0KICAgIGlmICggZXZlbnQgJiYgZXZlbnQucHJldmVudERlZmF1bHQgKQ0KICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpDQoNCiAgICBpZiAoIHRoaXMucGFzc3dvcmQgIT09IHRoaXMuY29uZmlybVBhc3N3b3JkICkNCiAgICAgICAgcmV0dXJuDQoNCiAgICB2YXIgcG9zdCA9IEpTT04ucGFyc2UoIEpTT04uc3RyaW5naWZ5KHRoaXMudXNlcikgKQ0KDQogICAgaWYgKCB0aGlzLm5ld0F2YXRhciAhPT0gdW5kZWZpbmVkICkNCiAgICAgICAgcG9zdC5hdmF0YXIgPSB0aGlzLm5ld0F2YXRhcg0KDQogICAgbGV0IGVtcHR5ID0gT2JqZWN0LmtleXModGhpcy51c2VyKS5maW5kKGtleSA9PiB7DQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICAvLyBpZiAoIGtleSA9PT0gJ2F2YXRhcicgKQ0KICAgICAgICAvLyAgICAgcmV0dXJuIGZhbHNlDQoNCiAgICAgICAgLy8gZWxzZSByZXR1cm4gdGhpcy51c2VyW2tleV0gPT0gZmFsc2UNCiAgICB9KQ0KICAgIA0KICAgIGlmICggZW1wdHkgPT09IHVuZGVmaW5lZCApIHsNCiAgICAgICAgbGV0IHsgZGF0YSwgc3VjY2VzcyB9ID0gYXdhaXQgdGhpcy5hcGkucG9zdCgndXNlci91cGRhdGUnLCBwb3N0KQ0KDQogICAgICAgIGlmICggc3VjY2VzcyA9PT0gdHJ1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgndXNlcnMtbGlzdC1zZXQnLCBkYXRhKQ0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2xvc2VNb2RhbCIsIHRoaXMuaWQpDQogICAgICAgIH0NCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gY2FuY2VsICgpIHsNCiAgICByZXR1cm4gdGhpcy4kc3RvcmUuY29tbWl0KCJjbG9zZU1vZGFsIiwgdGhpcy5pZCkNCn0NCg=="},{"version":3,"sources":["EditUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"EditUser.vue","sourceRoot":"source/components/Modal","sourcesContent":["<template lang='pug'>\r\n\r\n    div#create-user( class='modal' )\r\n        h3( class='modal-title' ) Редактирование пользователя\r\n\r\n        form#form( class='blocks-div' @submit='save' )\r\n            div( class='inputs-div' )\r\n                InputText( class='create-input' placeholder='Фамилия' v-model='user.lastName' )\r\n                InputText( class='create-input' placeholder='Имя' v-model='user.firstName' )\r\n                InputText( class='create-input' placeholder='Отчество' v-model='user.patronymic' )\r\n                InputText( class='create-input' placeholder='ИИН' pattern='[0-9]{1,12}' v-model='user.iin' )\r\n                InputText( class='create-input' placeholder='Телефон' pattern='((\\\\+|7|8)+([0-9]{0,}))' v-model='user.phone' )\r\n                InputText( class='create-input' placeholder='Должность' v-model='user.position' )\r\n\r\n                Select( class='create-input' placeholder='Уровень доступа' :searchable='false' :list='userTypes' v-model='user.type' )\r\n\r\n            div( class='user-info-div' )\r\n                div( class='avatar-div' )\r\n                    img( class='avatar' :src='getAvatar(user.avatar)' )\r\n\r\n                InputFile( class='create-input' accept='image/*' v-model='user.newAvatar' )\r\n\r\n                InputText( class='create-input' disabled placeholder='Логин' v-model='user.login' )\r\n                InputText( class='create-input' type='password' placeholder='Пароль' v-model='user.password' )\r\n                InputText( class='create-input' type='password' placeholder='Повторите пароль' v-model='user.confirmPassword' )\r\n            \r\n\r\n        div( class='buttons-div' )\r\n            Button( title='Отменить' background='red' icon-top='2px' @click.native='cancel' )\r\n            Button( icon='create' title='Сохранить' background='green' icon-top='2px' @click.native='save' )\r\n                \r\n\r\n</template>\r\n\r\n<script>\r\nimport Button from ':src/components/UI/Button.vue'\r\n\r\nimport InputText from ':src/components/UI/Input/Text.vue'\r\nimport InputFile from ':src/components/UI/Input/File.vue'\r\nimport Select from ':src/components/UI/Input/Select.vue'\r\n\r\nexport default {\r\n    props: ['id', 'data'],\r\n    components: { InputText, InputFile, Select, Button },\r\n    computed: { cities },\r\n    methods: { getAvatar, save, cancel },\r\n    data: function () {\r\n        return {\r\n            userTypes: {\r\n                admin: 'Администратор',\r\n                manager: 'Управляющий'\r\n            },\r\n\r\n            user: this.data\r\n        }\r\n    }\r\n}\r\n\r\nfunction cities () {\r\n    var list = {}\r\n\r\n    this.$store.state.cities.forEach(city => {\r\n        list[city.code] = city.name\r\n    })\r\n\r\n    return list\r\n}\r\n\r\nfunction getAvatar (avatar) {\r\n    if ( avatar == undefined || avatar == false )\r\n        return '/images/avatar.png'\r\n    \r\n    else return 'data:image/png;base64, ' + avatar\r\n}\r\n\r\nasync function save (event) {\r\n    if ( event && event.preventDefault )\r\n        event.preventDefault()\r\n\r\n    if ( this.password !== this.confirmPassword )\r\n        return\r\n\r\n    var post = JSON.parse( JSON.stringify(this.user) )\r\n\r\n    if ( this.newAvatar !== undefined )\r\n        post.avatar = this.newAvatar\r\n\r\n    let empty = Object.keys(this.user).find(key => {\r\n        return false\r\n        // if ( key === 'avatar' )\r\n        //     return false\r\n\r\n        // else return this.user[key] == false\r\n    })\r\n    \r\n    if ( empty === undefined ) {\r\n        let { data, success } = await this.api.post('user/update', post)\r\n\r\n        if ( success === true ) {\r\n            this.$store.commit('users-list-set', data)\r\n            return this.$store.commit(\"closeModal\", this.id)\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction cancel () {\r\n    return this.$store.commit(\"closeModal\", this.id)\r\n}\r\n</script>\r\n\r\n<style lang='stylus'>\r\n@import '~src/style/palette'\r\n\r\n#create-user\r\n    padding 24px\r\n\r\n    .create-input\r\n        display block\r\n        margin 12px 0\r\n\r\n    .buttons-div\r\n        border-top 1px solid lighten($light-gray, 15)\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 8px\r\n        padding-top 16px\r\n\r\n    #form\r\n        align-items flex-start\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 18px\r\n\r\n        .user-info-div\r\n            margin-left 16px\r\n\r\n    .avatar-div\r\n        align-items center\r\n        display flex\r\n        justify-content center\r\n        margin-bottom 8px\r\n\r\n        .avatar\r\n            max-height 400px\r\n            max-width 100%\r\n\r\n</style>"]}]}