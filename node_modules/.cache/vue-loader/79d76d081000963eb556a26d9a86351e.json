{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\CreateUser.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\CreateUser.vue","mtime":1576385170922},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQnV0dG9uIGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9CdXR0b24udnVlJw0KDQppbXBvcnQgSW5wdXRUZXh0IGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9JbnB1dC9UZXh0LnZ1ZScNCmltcG9ydCBJbnB1dEZpbGUgZnJvbSAnOnNyYy9jb21wb25lbnRzL1VJL0lucHV0L0ZpbGUudnVlJw0KaW1wb3J0IFNlbGVjdCBmcm9tICc6c3JjL2NvbXBvbmVudHMvVUkvSW5wdXQvU2VsZWN0LnZ1ZScNCg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIHByb3BzOiBbJ2lkJywgJ2RhdGEnXSwNCiAgICBjb21wb25lbnRzOiB7IElucHV0VGV4dCwgSW5wdXRGaWxlLCBTZWxlY3QsIEJ1dHRvbiB9LA0KICAgIGNvbXB1dGVkOiB7IGNpdGllcyB9LA0KICAgIG1ldGhvZHM6IHsgZGVmYXVsdHMsIHNhdmUsIGNhbmNlbCB9LA0KICAgIGRhdGE6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIHVzZXJUeXBlczogew0KICAgICAgICAgICAgICAgIGFkbWluOiAn0JDQtNC80LjQvdC40YHRgtGA0LDRgtC+0YAnLA0KICAgICAgICAgICAgICAgIG1hbmFnZXI6ICfQo9C/0YDQsNCy0LvRj9GO0YnQuNC5Jw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgdXNlcjogew0KICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogJycsDQogICAgICAgICAgICAgICAgbGFzdE5hbWU6ICcnLA0KICAgICAgICAgICAgICAgIHBhdHJvbnltaWM6ICcnLA0KICAgICAgICAgICAgICAgIGlpbjogJycsDQogICAgICAgICAgICAgICAgcGhvbmU6ICcnLA0KICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnJywNCiAgICAgICAgICAgICAgICB0eXBlOiAnYWRtaW4nLA0KDQogICAgICAgICAgICAgICAgYXZhdGFyOiB1bmRlZmluZWQsDQogICAgICAgICAgICAgICAgbG9naW46ICcnLA0KICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAnJywNCiAgICAgICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGNpdGllcyAoKSB7DQogICAgdmFyIGxpc3QgPSB7fQ0KDQogICAgdGhpcy4kc3RvcmUuc3RhdGUuY2l0aWVzLmZvckVhY2goY2l0eSA9PiB7DQogICAgICAgIGxpc3RbY2l0eS5jb2RlXSA9IGNpdHkubmFtZQ0KICAgIH0pDQoNCiAgICByZXR1cm4gbGlzdA0KfQ0KDQpmdW5jdGlvbiBkZWZhdWx0cyAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgICAgZmlyc3ROYW1lOiAnJywNCiAgICAgICAgbGFzdE5hbWU6ICcnLA0KICAgICAgICBwYXRyb255bWljOiAnJywNCiAgICAgICAgaWluOiAnJywNCiAgICAgICAgcGhvbmU6ICcnLA0KICAgICAgICBwb3NpdGlvbjogJycsDQogICAgICAgIHR5cGU6ICdhZG1pbicsDQoNCiAgICAgICAgYXZhdGFyOiB1bmRlZmluZWQsDQogICAgICAgIGxvZ2luOiAnJywNCiAgICAgICAgcGFzc3dvcmQ6ICcnLA0KICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICcnDQogICAgfQ0KfQ0KDQphc3luYyBmdW5jdGlvbiBzYXZlIChldmVudCkgew0KICAgIGlmICggZXZlbnQgJiYgZXZlbnQucHJldmVudERlZmF1bHQgKQ0KICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpDQoNCiAgICBpZiAoIHRoaXMucGFzc3dvcmQgIT09IHRoaXMuY29uZmlybVBhc3N3b3JkICkNCiAgICAgICAgcmV0dXJuDQoNCiAgICBsZXQgZW1wdHkgPSBPYmplY3Qua2V5cyh0aGlzLnVzZXIpLmZpbmQoa2V5ID0+IHsNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIC8vIGlmICgga2V5ID09PSAnYXZhdGFyJyApDQogICAgICAgIC8vICAgICByZXR1cm4gZmFsc2UNCg0KICAgICAgICAvLyBlbHNlIHJldHVybiB0aGlzLnVzZXJba2V5XSA9PSBmYWxzZQ0KICAgIH0pDQoNCiAgICBpZiAoIGVtcHR5ID09PSB1bmRlZmluZWQgKSB7DQogICAgICAgIGxldCB7IGRhdGEsIHN1Y2Nlc3MgfSA9IGF3YWl0IHRoaXMuYXBpLnBvc3QoJ3VzZXIvc2lnbi11cCcsIHRoaXMudXNlcikNCg0KICAgICAgICBpZiAoIHN1Y2Nlc3MgPT09IHRydWUgKSB7DQogICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXJzLWxpc3Qtc2V0JywgZGF0YSkNCiAgICAgICAgICAgIHRoaXMuZG9ybWl0b3J5ID0gdGhpcy5kZWZhdWx0cygpDQogICAgICAgICAgICANCiAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5jb21taXQoImNsb3NlTW9kYWwiLCB0aGlzLmlkKQ0KICAgICAgICB9DQogICAgfQ0KDQp9DQoNCmZ1bmN0aW9uIGNhbmNlbCAoKSB7DQogICAgcmV0dXJuIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2xvc2VNb2RhbCIsIHRoaXMuaWQpDQp9DQo="},{"version":3,"sources":["CreateUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"CreateUser.vue","sourceRoot":"source/components/Modal","sourcesContent":["<template lang='pug'>\r\n\r\n    div#create-user( class='modal' )\r\n        h3( class='modal-title' ) Создание пользователя\r\n\r\n        form#form( class='blocks-div' @submit='save' )\r\n            div( class='inputs-div' )\r\n                InputText( class='create-input' placeholder='Фамилия' v-model='user.lastName' )\r\n                InputText( class='create-input' placeholder='Имя' v-model='user.firstName' )\r\n                InputText( class='create-input' placeholder='Отчество' v-model='user.patronymic' )\r\n                InputText( class='create-input' placeholder='ИИН' pattern='[0-9]{1,12}' v-model='user.iin' )\r\n                InputText( class='create-input' placeholder='Телефон' pattern='((\\\\+|7|8)+([0-9]{0,}))' v-model='user.phone' )\r\n                InputText( class='create-input' placeholder='Должность' v-model='user.position' )\r\n\r\n                Select( class='create-input' placeholder='Уровень доступа' :searchable='false' :list='userTypes' v-model='user.type' )\r\n\r\n            div( class='user-info-div' )\r\n                div( class='avatar-div' )\r\n                    img( class='avatar' src='/images/avatar.png' )\r\n\r\n                InputFile( class='create-input' accept='image/*' v-model='user.avatar' )\r\n\r\n                InputText( class='create-input' placeholder='Логин' v-model='user.login' )\r\n                InputText( class='create-input' type='password' placeholder='Пароль' v-model='user.password' )\r\n                InputText( class='create-input' type='password' placeholder='Повторите пароль' v-model='user.confirmPassword' )\r\n            \r\n\r\n        div( class='buttons-div' )\r\n            Button( title='Отменить' background='red' icon-top='2px' @click.native='cancel' )\r\n            Button( icon='create' title='Создать' background='green' icon-top='2px' @click.native='save' )\r\n                \r\n\r\n</template>\r\n\r\n<script>\r\nimport Button from ':src/components/UI/Button.vue'\r\n\r\nimport InputText from ':src/components/UI/Input/Text.vue'\r\nimport InputFile from ':src/components/UI/Input/File.vue'\r\nimport Select from ':src/components/UI/Input/Select.vue'\r\n\r\nexport default {\r\n    props: ['id', 'data'],\r\n    components: { InputText, InputFile, Select, Button },\r\n    computed: { cities },\r\n    methods: { defaults, save, cancel },\r\n    data: function () {\r\n        return {\r\n            userTypes: {\r\n                admin: 'Администратор',\r\n                manager: 'Управляющий'\r\n            },\r\n\r\n            user: {\r\n                firstName: '',\r\n                lastName: '',\r\n                patronymic: '',\r\n                iin: '',\r\n                phone: '',\r\n                position: '',\r\n                type: 'admin',\r\n\r\n                avatar: undefined,\r\n                login: '',\r\n                password: '',\r\n                confirmPassword: ''\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction cities () {\r\n    var list = {}\r\n\r\n    this.$store.state.cities.forEach(city => {\r\n        list[city.code] = city.name\r\n    })\r\n\r\n    return list\r\n}\r\n\r\nfunction defaults () {\r\n    return {\r\n        firstName: '',\r\n        lastName: '',\r\n        patronymic: '',\r\n        iin: '',\r\n        phone: '',\r\n        position: '',\r\n        type: 'admin',\r\n\r\n        avatar: undefined,\r\n        login: '',\r\n        password: '',\r\n        confirmPassword: ''\r\n    }\r\n}\r\n\r\nasync function save (event) {\r\n    if ( event && event.preventDefault )\r\n        event.preventDefault()\r\n\r\n    if ( this.password !== this.confirmPassword )\r\n        return\r\n\r\n    let empty = Object.keys(this.user).find(key => {\r\n        return false\r\n        // if ( key === 'avatar' )\r\n        //     return false\r\n\r\n        // else return this.user[key] == false\r\n    })\r\n\r\n    if ( empty === undefined ) {\r\n        let { data, success } = await this.api.post('user/sign-up', this.user)\r\n\r\n        if ( success === true ) {\r\n            this.$store.commit('users-list-set', data)\r\n            this.dormitory = this.defaults()\r\n            \r\n            return this.$store.commit(\"closeModal\", this.id)\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction cancel () {\r\n    return this.$store.commit(\"closeModal\", this.id)\r\n}\r\n</script>\r\n\r\n<style lang='stylus'>\r\n@import '~src/style/palette'\r\n\r\n#create-user\r\n    padding 24px\r\n\r\n    .create-input\r\n        display block\r\n        margin 12px 0\r\n\r\n    .buttons-div\r\n        border-top 1px solid lighten($light-gray, 15)\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 8px\r\n        padding-top 16px\r\n\r\n    #form\r\n        align-items flex-start\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 18px\r\n\r\n        .user-info-div\r\n            margin-left 16px\r\n\r\n    .avatar-div\r\n        align-items center\r\n        display flex\r\n        justify-content center\r\n        margin-bottom 8px\r\n\r\n        .avatar\r\n            max-height 400px\r\n            max-width 100%\r\n\r\n</style>"]}]}