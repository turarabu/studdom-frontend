{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\EditDormitory.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Modal\\EditDormitory.vue","mtime":1577248280180},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQnV0dG9uIGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9CdXR0b24udnVlJw0KDQppbXBvcnQgSW5wdXRUZXh0IGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9JbnB1dC9UZXh0LnZ1ZScNCmltcG9ydCBTZWxlY3QgZnJvbSAnOnNyYy9jb21wb25lbnRzL1VJL0lucHV0L1NlbGVjdC52dWUnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBwcm9wczogWydpZCcsICdkYXRhJ10sDQogICAgY29tcG9uZW50czogeyBJbnB1dFRleHQsIFNlbGVjdCwgQnV0dG9uIH0sDQogICAgY29tcHV0ZWQ6IHsgY2l0aWVzIH0sDQogICAgbWV0aG9kczogeyBzYXZlLCBjYW5jZWwgfSwNCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIGZ1bmN0aW9uIGdldENvb3JkaW5hdGVzIChjb29yZGluYXRlcykgew0KICAgICAgICAgICAgaWYgKCBjb29yZGluYXRlcy54ID09PSB1bmRlZmluZWQgKQ0KICAgICAgICAgICAgICAgIHJldHVybiBjb29yZGluYXRlcw0KDQogICAgICAgICAgICBlbHNlIHJldHVybiBgJHtjb29yZGluYXRlcy54fSwgJHtjb29yZGluYXRlcy55fWANCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBkb3JtaXRvcnk6IHsNCiAgICAgICAgICAgICAgICBjb2RlOiB0aGlzLmRhdGEuY29kZSwNCiAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLmRhdGEubmFtZSwNCiAgICAgICAgICAgICAgICBjaXR5OiB0aGlzLmRhdGEuY2l0eSwNCiAgICAgICAgICAgICAgICBjYXBhY2l0eTogdGhpcy5kYXRhLmNhcGFjaXR5IHx8IHRoaXMuZGF0YS5saW1pdCwNCiAgICAgICAgICAgICAgICBjb29yZGluYXRlczogZ2V0Q29vcmRpbmF0ZXModGhpcy5kYXRhLmNvb3JkaW5hdGVzKSwNCiAgICAgICAgICAgICAgICBsb2dpbjogdGhpcy5kYXRhLmxvZ2luLA0KICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAnJw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBjaXRpZXMgKCkgew0KICAgIHZhciBsaXN0ID0ge30NCg0KICAgIHRoaXMuJHN0b3JlLnN0YXRlLmNpdGllcy5mb3JFYWNoKGNpdHkgPT4gew0KICAgICAgICBsaXN0W2NpdHkuY29kZV0gPSBjaXR5Lm5hbWUNCiAgICB9KQ0KDQogICAgcmV0dXJuIGxpc3QNCn0NCg0KYXN5bmMgZnVuY3Rpb24gc2F2ZSAoZXZlbnQpIHsNCiAgICBpZiAoIGV2ZW50ICYmIGV2ZW50LnByZXZlbnREZWZhdWx0ICkNCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKQ0KDQogICAgY29uc29sZS5sb2codGhpcy5kb3JtaXRvcnkpDQoNCiAgICBsZXQgcG9zdCA9IEpTT04ucGFyc2UoIEpTT04uc3RyaW5naWZ5KHRoaXMuZG9ybWl0b3J5KSApDQogICAgbGV0IGVtcHR5ID0gT2JqZWN0LmtleXMocG9zdCkuZmluZChrZXkgPT4gew0KICAgICAgICBpZiAoIGtleSA9PT0gJ3Bhc3N3b3JkJyAmJiBwb3N0W2tleV0gPT0gZmFsc2UgKSB7DQogICAgICAgICAgICBkZWxldGUgcG9zdFtrZXldDQogICAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHBvc3Rba2V5XSA9PSBmYWxzZQ0KICAgIH0pDQoNCiAgICBpZiAoIGVtcHR5ID09PSB1bmRlZmluZWQgKSB7DQogICAgICAgIGxldCB7IGRhdGEsIHN1Y2Nlc3MgfSA9IGF3YWl0IHRoaXMuYXBpLnBvc3QoJ2Rvcm1pdG9yeS91cGRhdGUnLCBwb3N0KQ0KDQogICAgICAgIGlmICggc3VjY2VzcyA9PT0gdHJ1ZSApIHsNCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZG9ybWl0b3JpZXMtc2V0JywgZGF0YSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmNvbW1pdCgiY2xvc2VNb2RhbCIsIHRoaXMuaWQpDQogICAgICAgIH0NCiAgICB9DQoNCn0NCg0KZnVuY3Rpb24gY2FuY2VsICgpIHsNCiAgICByZXR1cm4gdGhpcy4kc3RvcmUuY29tbWl0KCJjbG9zZU1vZGFsIiwgdGhpcy5pZCkNCn0NCg=="},{"version":3,"sources":["EditDormitory.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA","file":"EditDormitory.vue","sourceRoot":"source/components/Modal","sourcesContent":["<template lang='pug'>\r\n\r\n    div#create-dormitory( class='modal' )\r\n        h3( class='modal-title' ) Редактирование общежития\r\n\r\n        form#create-form( class='blocks-div' @submit='save' )\r\n            div( class='inputs-div' )\r\n                InputText( class='create-input' placeholder='Название общежития' v-model='dormitory.name' )\r\n                Select( class='create-input' placeholder='Город' :list='cities' v-model='dormitory.city' )\r\n                InputText( class='create-input' placeholder='Вместимость (Человек)' pattern='[0-9]{1,6}' v-model='dormitory.capacity' )\r\n                InputText( class='create-input' placeholder='Координаты (Широта, Долгота)' v-model='dormitory.coordinates' )\r\n                InputText( class='create-input' disabled placeholder='Логин пользователя' v-model='dormitory.login' )\r\n                InputText( class='create-input' type='password' placeholder='Новый пароль пользователя' v-model='dormitory.password' )\r\n\r\n            div( class='turns-div' )\r\n                p( class='turns-title' ) Турникеты\r\n                div( class='turns-list' )\r\n                    div( class='head row' )\r\n                        span( class='data' ) №\r\n                        span( class='data' ) Название\r\n                        span( class='data' ) Статус\r\n\r\n                    div( v-if='dormitory.code === \"vkgtu\"' class='row' )\r\n                        span( class='data' ) 1\r\n                        span( class='data' ) Главный вход\r\n                        span( class='data' ) Активный\r\n\r\n        div( class='buttons-div' )\r\n            Button( title='Отменить' background='red' icon-top='2px' @click.native='cancel' )\r\n            Button( icon='create' title='Сохранить' background='green' icon-top='2px' @click.native='save' )\r\n                \r\n\r\n</template>\r\n\r\n<script>\r\nimport Button from ':src/components/UI/Button.vue'\r\n\r\nimport InputText from ':src/components/UI/Input/Text.vue'\r\nimport Select from ':src/components/UI/Input/Select.vue'\r\n\r\nexport default {\r\n    props: ['id', 'data'],\r\n    components: { InputText, Select, Button },\r\n    computed: { cities },\r\n    methods: { save, cancel },\r\n    data: function () {\r\n        function getCoordinates (coordinates) {\r\n            if ( coordinates.x === undefined )\r\n                return coordinates\r\n\r\n            else return `${coordinates.x}, ${coordinates.y}`\r\n        }\r\n\r\n        return {\r\n            dormitory: {\r\n                code: this.data.code,\r\n                name: this.data.name,\r\n                city: this.data.city,\r\n                capacity: this.data.capacity || this.data.limit,\r\n                coordinates: getCoordinates(this.data.coordinates),\r\n                login: this.data.login,\r\n                password: ''\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction cities () {\r\n    var list = {}\r\n\r\n    this.$store.state.cities.forEach(city => {\r\n        list[city.code] = city.name\r\n    })\r\n\r\n    return list\r\n}\r\n\r\nasync function save (event) {\r\n    if ( event && event.preventDefault )\r\n        event.preventDefault()\r\n\r\n    console.log(this.dormitory)\r\n\r\n    let post = JSON.parse( JSON.stringify(this.dormitory) )\r\n    let empty = Object.keys(post).find(key => {\r\n        if ( key === 'password' && post[key] == false ) {\r\n            delete post[key]\r\n            return false\r\n        }\r\n        \r\n        return post[key] == false\r\n    })\r\n\r\n    if ( empty === undefined ) {\r\n        let { data, success } = await this.api.post('dormitory/update', post)\r\n\r\n        if ( success === true ) {\r\n            this.$store.commit('dormitories-set', data)\r\n            \r\n            return this.$store.commit(\"closeModal\", this.id)\r\n        }\r\n    }\r\n\r\n}\r\n\r\nfunction cancel () {\r\n    return this.$store.commit(\"closeModal\", this.id)\r\n}\r\n</script>\r\n\r\n<style lang='stylus'>\r\n@import '~src/style/palette'\r\n\r\n#create-dormitory\r\n    padding 24px\r\n\r\n    .create-input\r\n        display block\r\n        margin 12px 0\r\n\r\n    .buttons-div\r\n        border-top 1px solid lighten($light-gray, 15)\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 8px\r\n        padding-top 16px\r\n\r\n    #create-form\r\n        align-items flex-start\r\n        display flex\r\n        justify-content space-between\r\n        margin-top 18px\r\n\r\n        .turns-div\r\n            margin-left 16px\r\n            position relative\r\n            top -14px\r\n            width 400px\r\n\r\n        .turns-title\r\n            color darken($light-gray, 25)\r\n            font-size 16px\r\n            font-weight 500\r\n\r\n        .turns-list\r\n            border 1px solid lighten($light-gray, 5)\r\n            border-radius 5px\r\n            margin-top 6px\r\n            padding 6px 0\r\n\r\n            .head\r\n                padding-bottom 6px\r\n\r\n                .data\r\n                    font-weight 500\r\n\r\n            .row\r\n                display flex\r\n                justify-content space-between\r\n\r\n            .data\r\n                padding 4px 12px\r\n                text-align left\r\n                width calc(100% - 40px - 140px - 3px)\r\n                &:first-child\r\n                    width 40px\r\n                &:last-child\r\n                    text-align right\r\n                    width 140px\r\n\r\n</style>"]}]}