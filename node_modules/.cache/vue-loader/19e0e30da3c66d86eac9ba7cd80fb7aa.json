{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Home\\SecondLine.vue?vue&type=style&index=0&lang=stylus&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Home\\SecondLine.vue","mtime":1577417686198},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\stylus-loader\\index.js","mtime":1519606876000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCkBpbXBvcnQgJ35zcmMvc3R5bGUvcGFsZXR0ZScNCg0KLnNlY29uZC1sZXZlbA0KICAgIGFsaWduLWl0ZW1zIHN0cmV0Y2gNCiAgICBkaXNwbGF5IGZsZXgNCiAgICBqdXN0aWZ5LWNvbnRlbnQgc3BhY2UtYmV0d2Vlbg0KDQogICAgLmJsb2NrDQogICAgICAgIHdpZHRoIDMzLjMzMzMlICFpbXBvcnRhbnQNCg0KLmRpYWctc2l6ZS0yDQogICAgYWxpZ24taXRlbXMgY2VudGVyDQogICAgYm9yZGVyIDFweCBzb2xpZCAkbGlnaHQtZ3JheQ0KICAgIGRpc3BsYXkgZmxleA0KICAgIGp1c3RpZnktY29udGVudCBjZW50ZXINCiAgICBoZWlnaHQgNDAwcHgNCiAgICB3aWR0aCA2Ni42NjY2JSAhaW1wb3J0YW50DQoNCi5kaWFnLXNpemUtMw0KICAgIGJvcmRlci1ib3R0b20gbm9uZSAhaW1wb3J0YW50DQogICAgYm9yZGVyLXJpZ2h0IG5vbmUgIWltcG9ydGFudA0KICAgIHdpZHRoIDEwMCUgIWltcG9ydGFudA0KICAgICY6bGFzdC1jaGlsZA0KICAgICAgICBib3JkZXItYm90dG9tIDFweCBzb2xpZCAkbGlnaHQtZ3JheSAhaW1wb3J0YW50DQoNCkBtZWRpYSAobWluLXdpZHRoOiAxNjAwcHgpDQoNCiAgICAuZGlhZy1zaXplLTINCiAgICAgICAgaGVpZ2h0IDQ4MHB4DQogICAgDQo="},{"version":3,"sources":["SecondLine.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoRA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA","file":"SecondLine.vue","sourceRoot":"source/components/Home","sourcesContent":["<template lang='pug'>\r\n    div( class='second-level' )\r\n        div( class='block' )\r\n            div( class='diag-size-1 diag-size-3 texts' )\r\n                div( class='home-data-line' )\r\n                    span( class='key-title' ) Рост студентов\r\n                        span( class='key-subtitle' ) За месяц\r\n\r\n                    span( class='value blue' ) +1\r\n\r\n                div( class='home-data-line' )\r\n                    span( class='key-title' ) Рост посещений\r\n                        span( class='key-subtitle' ) За месяц\r\n\r\n                    span( class='value red' ) +{{ allSigns() }}\r\n\r\n                div( class='home-data-line' )\r\n                    span( class='key-title' ) Посещений\r\n                        span( class='key-subtitle' ) Студента в среднем за месяц\r\n\r\n                    span( class='value purple' ) {{ allSigns() }}\r\n\r\n            div( class='diag-size-1 diag-size-3' )\r\n                figure( class='highcharts-figure' )\r\n                    div#second-level-3\r\n\r\n        div( class='diag-size-2' )\r\n            figure( class='highcharts-figure' )\r\n                div#second-level-2\r\n</template>\r\n\r\n<script>\r\nvar use = 1600\r\nvar screens = {\r\n    1366: {\r\n        height: 180,\r\n        width: 300,\r\n        fSize: '12px',\r\n        lWidth: 140\r\n    },\r\n\r\n    1600: {\r\n        height: 220,\r\n        width: 440,\r\n        fSize: '18px',\r\n        lWidth: 220\r\n    }\r\n}\r\n\r\n\r\nvar screens2 = {\r\n    1366: {\r\n        height: 390,\r\n        width: 670,\r\n        fSize: '18px',\r\n        lWidth: 140\r\n    },\r\n\r\n    1600: {\r\n        height: 440,\r\n        width: 850,\r\n        fSize: '18px',\r\n        lWidth: 220\r\n    }\r\n}\r\n\r\nexport default {\r\n    props: ['use'],\r\n    methods: { getSigns, allSigns, getByDays, firstLevel2, firstLevel3 },\r\n    mounted: start,\r\n    data: function () {\r\n        return {\r\n            byDate: false\r\n        }\r\n    }\r\n}\r\n\r\nfunction start () {\r\n    use = this.use\r\n    \r\n    this.firstLevel2()\r\n    this.firstLevel3()\r\n\r\n    this.$watch('use', newUse => {\r\n        use = newUse\r\n\r\n        this.firstLevel2()\r\n        this.firstLevel3()\r\n    })\r\n}\r\n\r\nasync function firstLevel2 () {\r\n    var series = await this.getByDays('month')\r\n\r\n    Highcharts.chart('second-level-2', {\r\n        title: { text: 'Динамика авторизации за месяц' },\r\n        colors: ['#7cb5ec', '#f7a35c', '#90ed7d', '#8085e9', '#f44236'],\r\n        subtitle: { text: new Date().toLocaleDateString('ru', { weekday: 'short', year: 'numeric', month: 'long', day: 'numeric'}) },\r\n        credits: { enabled: false },\r\n        legend: { enabled: false },\r\n        yAxis: { title: { text: '' } },\r\n        exporting: {\r\n            buttons: { contextButton: { enabled: false } }\r\n        },\r\n        \r\n        chart: {\r\n            type: 'areaspline',\r\n            height: screens2[use].height,\r\n            width: screens2[use].width\r\n        },\r\n\r\n        plotOptions: {\r\n            areaspline: { fillOpacity: 0.25 }\r\n        },\r\n\r\n        xAxis: {\r\n            categories: [\r\n                '1',\r\n                '2',\r\n                '3',\r\n                '4',\r\n                '5',\r\n                '6',\r\n                '7',\r\n                '8',\r\n                '9',\r\n                '10',\r\n                '11',\r\n                '12',\r\n                '13',\r\n                '14',\r\n                '15',\r\n                '16',\r\n                '17',\r\n                '18',\r\n                '19',\r\n                '20',\r\n                '21',\r\n                '22',\r\n                '23',\r\n                '24',\r\n                '25',\r\n                '26',\r\n                '27',\r\n                '28',\r\n                '29',\r\n                '30',\r\n                '31',\r\n            ]\r\n        },\r\n\r\n        series: [{\r\n            name: 'Авторизации',\r\n            data: series\r\n        }]\r\n    })\r\n}\r\n\r\nfunction firstLevel3 () {\r\n    Highcharts.chart('second-level-3', {\r\n        title: {\r\n            text: 'Активность за месяц',\r\n            margin: 16\r\n        },\r\n        colors: ['#7cb5ec', '#f7a35c', '#90ed7d', '#8085e9', '#f44236'],\r\n        credits: { enabled: false },\r\n        exporting: {\r\n            buttons: { contextButton: { enabled: false } }\r\n        },\r\n        legend: {\r\n            useHTML: true,\r\n            layout: 'vertical',\r\n            enabled: true,\r\n            align: 'right',\r\n            labelFormat: '<span class=\"legend-line\"><span>{name}</span> <span class=\"value\">{percentage:.2f}%</span></span>',\r\n            verticalAlign: 'middle',\r\n            width: screens[use].lWidth,\r\n            title: {\r\n                text: '<span class=\"legend-line title\"><span>Общежитие</span> <span class=\"value\">Посещений</span></span>'\r\n            },\r\n            itemStyle: {\r\n                display: 'inline-block',\r\n                fontSize: screens[use].fSize,\r\n                fontWeight: 400,\r\n                width: screens[use].lWidth\r\n            }\r\n        },\r\n        chart: {\r\n            plotBackgroundColor: null,\r\n            plotBorderWidth: null,\r\n            plotShadow: false,\r\n            type: 'pie',\r\n            height: screens[use].height,\r\n            width: screens[use].width\r\n        },\r\n        plotOptions: {\r\n            pie: {\r\n                allowPointSelect: true,\r\n                cursor: 'pointer',\r\n                dataLabels: { enabled: false },\r\n                showInLegend: true\r\n            }\r\n        },\r\n        series: [{\r\n            name: 'Авторизации',\r\n            colorByPoint: true,\r\n            data: this.getSigns()\r\n        }]\r\n    })\r\n}\r\n\r\nfunction getSigns () {\r\n    var result = []\r\n    var dormitories = JSON.parse( JSON.stringify(this.$store.state.dormitories.list))\r\n    dormitories.sort((a, b) => b.signs - a.signs)\r\n\r\n    for (let i = 0; i != dormitories.length; ++i) {\r\n        if ( i >= 4 ) {\r\n            if ( result[4] === undefined )\r\n                result[4] = { y: 0 }\r\n                \r\n            result[4].name = 'Другие'\r\n            result[4].y += parseSigns(dormitories[i].signs) || 0\r\n        }\r\n\r\n        else {\r\n            result.push({\r\n                name: dormitories[i].name,\r\n                y: parseSigns(dormitories[i].signs)\r\n            })\r\n        }\r\n    }\r\n\r\n    return result\r\n}\r\n\r\nfunction allSigns () {\r\n    var dormitories = this.$store.state.dormitories.list\r\n    var count = 0\r\n\r\n    dormitories.forEach(dormitory => {\r\n        count += parseSigns(dormitory.signs)\r\n    })\r\n\r\n    return count\r\n}\r\n\r\nasync function getByDays (type) {\r\n    return new Promise(async resolve => {\r\n        let result = []\r\n\r\n        if ( this.byDate === false ) {\r\n            var { data } = await this.api.get('sign/list')\r\n            this.byDate = data\r\n            result = data[type]\r\n        }\r\n\r\n        else result = this.byDate[type]\r\n\r\n        result.forEach((value, index) => {\r\n            if (value === null)\r\n                result[index] = 0\r\n        })\r\n\r\n        resolve(result)\r\n    })\r\n}\r\n\r\nfunction parseSigns (signs) {\r\n    return (signs.length === undefined)\r\n        ? signs || 0\r\n        : signs.length\r\n}\r\n</script>\r\n\r\n<style lang='stylus'>\r\n@import '~src/style/palette'\r\n\r\n.second-level\r\n    align-items stretch\r\n    display flex\r\n    justify-content space-between\r\n\r\n    .block\r\n        width 33.3333% !important\r\n\r\n.diag-size-2\r\n    align-items center\r\n    border 1px solid $light-gray\r\n    display flex\r\n    justify-content center\r\n    height 400px\r\n    width 66.6666% !important\r\n\r\n.diag-size-3\r\n    border-bottom none !important\r\n    border-right none !important\r\n    width 100% !important\r\n    &:last-child\r\n        border-bottom 1px solid $light-gray !important\r\n\r\n@media (min-width: 1600px)\r\n\r\n    .diag-size-2\r\n        height 480px\r\n    \r\n</style>"]}]}