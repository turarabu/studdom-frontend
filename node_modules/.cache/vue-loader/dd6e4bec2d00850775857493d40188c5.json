{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Dormitories\\Tables\\Turnstile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Dormitories\\Tables\\Turnstile.vue","mtime":1576087452146},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogICAgcHJvcHM6IFsnZG9ybWl0b3J5J10sDQogICAgY29tcHV0ZWQ6IHsgdHVybnN0aWxlcywgYWxsIH0sDQogICAgbWV0aG9kczogeyBnZXRMYXN0QWN0aXZlLCB0b0RhdGUgfQ0KfQ0KDQpmdW5jdGlvbiB0dXJuc3RpbGVzICgpIHsNCiAgICByZXR1cm4gdGhpcy5kb3JtaXRvcnkudHVybnN0aWxlcyB8fCBbXQ0KfQ0KDQpmdW5jdGlvbiBnZXRMYXN0QWN0aXZlIChpZCkgew0KICAgIHZhciBsYXN0ID0gMA0KDQogICAgZm9yICggbGV0IHNpZ24gb2YgdGhpcy5kb3JtaXRvcnkuc2lnbnMgKSB7DQogICAgICAgIGlmICggc2lnbi50dXJuc3RpbGUgPT0gaWQgKSB7DQogICAgICAgICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKHNpZ24uZGF0ZSkNCg0KICAgICAgICAgICAgaWYgKCBkYXRlID4gbGFzdCApDQogICAgICAgICAgICAgICAgbGFzdCA9IGRhdGUNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybiB0aGlzLnRvRGF0ZShsYXN0KQ0KfQ0KDQpmdW5jdGlvbiBhbGwgKCkgew0KICAgIHJldHVybiB0aGlzLmRvcm1pdG9yeS5zaWducy5sZW5ndGggfHwgMA0KfQ0KDQpmdW5jdGlvbiB0b0RhdGUgKHN0cmluZykgew0KICAgIGlmICggc3RyaW5nID09IDAgKQ0KICAgICAgICByZXR1cm4gJ9Cd0LjQutC+0LPQtNCwJw0KDQogICAgZWxzZSByZXR1cm4gbmV3IERhdGUoc3RyaW5nKS50b0xvY2FsZURhdGVTdHJpbmcoJ3J1Jywgew0KICAgICAgICB5ZWFyOiAnbnVtZXJpYycsDQogICAgICAgIGRheTogJ251bWVyaWMnLA0KICAgICAgICBtb250aDogJ2xvbmcnLA0KICAgICAgICBob3VyOiAnbnVtZXJpYycsDQogICAgICAgIG1pbnV0ZTogJ251bWVyaWMnDQogICAgfSkucmVwbGFjZSgnINCzLicsICcnKQ0KfQ0K"},{"version":3,"sources":["Turnstile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Turnstile.vue","sourceRoot":"source/components/Dormitories/Tables","sourcesContent":["<template lang='pug'>\r\n    table( class='dormitories-table' )\r\n        thead( class='not-body head' )\r\n            tr( class='row' )\r\n                th( class='data' ) Название\r\n                th( class='data' ) Статус\r\n                th( class='data' ) Дата и время последней авторизации\r\n\r\n        tbody( class='body' )\r\n            tr( v-for='(turnstile, id) in turnstiles' class='row' :key='id' )\r\n                td( class='data' ) {{ turnstile.name }}\r\n                td( class='data' ) {{ turnstile.active ? 'Активный' : 'Отключен' }}\r\n                td( class='data' ) {{ getLastActive(turnstile.id) }}\r\n\r\n        tfoot( class='not-body foot' )\r\n            tr( class='row' )\r\n                th( class='data' colspan='2' ) Всего\r\n                td( class='data' ) {{ all }}\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    props: ['dormitory'],\r\n    computed: { turnstiles, all },\r\n    methods: { getLastActive, toDate }\r\n}\r\n\r\nfunction turnstiles () {\r\n    return this.dormitory.turnstiles || []\r\n}\r\n\r\nfunction getLastActive (id) {\r\n    var last = 0\r\n\r\n    for ( let sign of this.dormitory.signs ) {\r\n        if ( sign.turnstile == id ) {\r\n            let date = new Date(sign.date)\r\n\r\n            if ( date > last )\r\n                last = date\r\n        }\r\n    }\r\n\r\n    return this.toDate(last)\r\n}\r\n\r\nfunction all () {\r\n    return this.dormitory.signs.length || 0\r\n}\r\n\r\nfunction toDate (string) {\r\n    if ( string == 0 )\r\n        return 'Никогда'\r\n\r\n    else return new Date(string).toLocaleDateString('ru', {\r\n        year: 'numeric',\r\n        day: 'numeric',\r\n        month: 'long',\r\n        hour: 'numeric',\r\n        minute: 'numeric'\r\n    }).replace(' г.', '')\r\n}\r\n</script>"]}]}