{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Reports\\CreateReport.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\components\\Reports\\CreateReport.vue","mtime":1577187236554},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgQnV0dG9uIGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9CdXR0b24udnVlJw0KaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gJzpzcmMvY29tcG9uZW50cy9VSS9PcHRpb25zTGlzdC52dWUnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBjb21wb25lbnRzOiB7IEJ1dHRvbiwgT3B0aW9uc0xpc3QgfSwNCiAgICBjb21wdXRlZDogeyBkb3JtaXRvcmllcywgc29ydGVkRG9ybWl0b3JpZXMsIHRoZUxlbmd0aCB9LA0KICAgIG1ldGhvZHM6IHsgZG93bmxvYWQgfSwNCiAgICBtb3VudGVkOiBzdGFydCwNCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKQ0KDQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBmcm9tOiBgJHsgZGF0ZS5nZXRGdWxsWWVhcigpIH0tJHsgZGF0ZS5nZXRNb250aCgpICsgMSB9LSR7IGRhdGUuZ2V0RGF0ZSgpIC0gNSB9YCwNCiAgICAgICAgICAgIHRvOiBgJHsgZGF0ZS5nZXRGdWxsWWVhcigpIH0tJHsgZGF0ZS5nZXRNb250aCgpICsgMSB9LSR7IGRhdGUuZ2V0RGF0ZSgpIH1gLA0KICAgICAgICAgICAgc2VhcmNoOiAnJywNCiAgICAgICAgICAgIHNlbGVjdGVkOiB7DQogICAgICAgICAgICAgICAgcmVwb3J0OiAnc2lnbi1pbicsDQogICAgICAgICAgICAgICAgZG9ybWl0b3J5OiAnYWxsJw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgcmVwb3J0VHlwZXM6IHsNCiAgICAgICAgICAgICAgICAnc2lnbi1pbic6ICfQodGC0LDRgtC40YHRgtC40LrQsCDQv9C+INCw0LLRgtC+0YDQuNC30LDRhtC40Y/QvCcsDQogICAgICAgICAgICAgICAgJ3NpZ24tdXAnOiAn0KHRgtCw0YLQuNGB0YLQuNC60LAg0L/QviDRgNC10LPQuNGB0YLRgNCw0YbQuNGP0LwnLA0KICAgICAgICAgICAgICAgICdjb25zb2xpZGF0ZSc6ICfQodCy0L7QtNC90YvQuSDQvtGC0YfQtdGCINC/0L4g0L7QsdGJ0LXQttC40YLQuNGP0LwnLA0KICAgICAgICAgICAgICAgICd0dXJuc3RpbGVzJzogJ9Ce0YLRh9C10YIg0L/QviDRgtC10YDQvNC40L3QsNC70LDQvCcsDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGRvcm1pdG9yaWVzICgpIHsNCiAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZG9ybWl0b3JpZXMubGlzdA0KfQ0KDQpmdW5jdGlvbiB0aGVMZW5ndGggKCkgew0KICAgIHJldHVybiB0aGlzLnNvcnRlZERvcm1pdG9yaWVzICYmIE9iamVjdC5rZXlzKHRoaXMuc29ydGVkRG9ybWl0b3JpZXMpLmxlbmd0aA0KfQ0KDQpmdW5jdGlvbiBzb3J0ZWREb3JtaXRvcmllcyAoKSB7DQogICAgdmFyIGxpc3QgPSB7DQogICAgICAgIGFsbDogJ9CS0YHQtSDQvtCx0YnQtdC20LjRgtC40Y8nDQogICAgfQ0KDQogICAgaWYgKCB0aGlzLiRzdG9yZS5zdGF0ZS5kb3JtaXRvcmllcy5saXN0ICkgew0KICAgICAgICB0aGlzLmRvcm1pdG9yaWVzLmZvckVhY2goZG9ybWl0b3J5ID0+IHsNCiAgICAgICAgICAgIGlmICggZG9ybWl0b3J5Lm5hbWUudG9Mb3dlckNhc2UoKS5zZWFyY2goICh0aGlzLnNlYXJjaCB8fCAnJykudG9Mb3dlckNhc2UoKSApID4gLTEgKQ0KICAgICAgICAgICAgICAgIGxpc3RbZG9ybWl0b3J5LmNvZGVdID0gZG9ybWl0b3J5Lm5hbWUNCiAgICAgICAgfSkNCg0KICAgICAgICBpZiAoIHRoaXMuc2VhcmNoLmxlbmd0aCA+IDAgKQ0KICAgICAgICAgICAgZGVsZXRlIGxpc3QuYWxsDQogICAgfQ0KDQogICAgcmV0dXJuIGxpc3QNCn0NCg0KZnVuY3Rpb24gZG93bmxvYWQgKCkgew0KICAgIHZhciByYW5nZSA9IGBmcm9tPSR7IHRoaXMuZnJvbSB9JnRvPSR7IHRoaXMudG8gfWANCiAgICB2YXIgdHlwZXMgPSBgdHlwZT0keyB0aGlzLnNlbGVjdGVkLnJlcG9ydCB9JmRvcm1pdG9yeT0keyB0aGlzLnNlbGVjdGVkLmRvcm1pdG9yeSB9YA0KDQoNCiAgICB3aW5kb3cub3BlbihgaHR0cHM6Ly9hcGkuc3R1ZGRvbS5ob3N0L3JlY29yZC9wZGY/JHsgcmFuZ2UgfSYkeyB0eXBlcyB9YCwgJ19ibGFuaycpDQp9DQoNCmZ1bmN0aW9uIHN0YXJ0ICgpIHsNCiAgICB0aGlzLiR3YXRjaCgnc2VhcmNoJywgKCkgPT4gew0KICAgICAgICB0aGlzLnNlbGVjdGVkLmRvcm1pdG9yeSA9IDANCiAgICB9KQ0KDQogICAgdGhpcy4kd2F0Y2goJ2Zyb20nLCB2YWx1ZSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKHZhbHVlKQ0KICAgIH0pDQp9DQo="},{"version":3,"sources":["CreateReport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"CreateReport.vue","sourceRoot":"source/components/Reports","sourcesContent":["<template lang='pug'>\r\n    div( class='create-report' )\r\n        p( class='bold-text' ) Пероид отчётности\r\n        div( class='period-div' )\r\n            span( class='datepicker-placeholder' ) С\r\n            input( class='record-datepicker' type='date' placeholder='С' v-model='from' )\r\n\r\n            span( class='datepicker-placeholder' ) По\r\n            input( class='record-datepicker' type='date' placeholder='По' v-model='to' )\r\n\r\n        div( class='blocks-div' )\r\n            div( class='block' )\r\n                div( class='bold-text-div' )\r\n                    p( class='bold-text' ) Вид отчётности\r\n                div( class='options-div' )\r\n                    OptionsList( :list='reportTypes' name='reportType' v-model='selected.report' )\r\n\r\n                Button( icon='upload' title='Выгрузить в формате PDF' background='green' icon-top='3px' @click.native='download' )\r\n\r\n\r\n            div( class='block' )\r\n                div( class='bold-text-div' )\r\n                    p( class='bold-text' ) Субъекты отчётности\r\n                    input( class='search' placeholder='Поиск субъекта...' v-model='search' )\r\n\r\n                div( class='options-div' )\r\n                    OptionsList( v-if='theLength > 0' :list='sortedDormitories' name='dormitory' v-model='selected.dormitory' )\r\n                    span( v-else class='not-found' ) Не найдено\r\n\r\n</template>\r\n\r\n<script>\r\nimport Button from ':src/components/UI/Button.vue'\r\nimport OptionsList from ':src/components/UI/OptionsList.vue'\r\n\r\nexport default {\r\n    components: { Button, OptionsList },\r\n    computed: { dormitories, sortedDormitories, theLength },\r\n    methods: { download },\r\n    mounted: start,\r\n    data: function () {\r\n        var date = new Date()\r\n\r\n        return {\r\n            from: `${ date.getFullYear() }-${ date.getMonth() + 1 }-${ date.getDate() - 5 }`,\r\n            to: `${ date.getFullYear() }-${ date.getMonth() + 1 }-${ date.getDate() }`,\r\n            search: '',\r\n            selected: {\r\n                report: 'sign-in',\r\n                dormitory: 'all'\r\n            },\r\n\r\n            reportTypes: {\r\n                'sign-in': 'Статистика по авторизациям',\r\n                'sign-up': 'Статистика по регистрациям',\r\n                'consolidate': 'Сводный отчет по общежитиям',\r\n                'turnstiles': 'Отчет по терминалам',\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction dormitories () {\r\n    return this.$store.state.dormitories.list\r\n}\r\n\r\nfunction theLength () {\r\n    return this.sortedDormitories && Object.keys(this.sortedDormitories).length\r\n}\r\n\r\nfunction sortedDormitories () {\r\n    var list = {\r\n        all: 'Все общежития'\r\n    }\r\n\r\n    if ( this.$store.state.dormitories.list ) {\r\n        this.dormitories.forEach(dormitory => {\r\n            if ( dormitory.name.toLowerCase().search( (this.search || '').toLowerCase() ) > -1 )\r\n                list[dormitory.code] = dormitory.name\r\n        })\r\n\r\n        if ( this.search.length > 0 )\r\n            delete list.all\r\n    }\r\n\r\n    return list\r\n}\r\n\r\nfunction download () {\r\n    var range = `from=${ this.from }&to=${ this.to }`\r\n    var types = `type=${ this.selected.report }&dormitory=${ this.selected.dormitory }`\r\n\r\n\r\n    window.open(`https://api.studdom.host/record/pdf?${ range }&${ types }`, '_blank')\r\n}\r\n\r\nfunction start () {\r\n    this.$watch('search', () => {\r\n        this.selected.dormitory = 0\r\n    })\r\n\r\n    this.$watch('from', value => {\r\n        console.log(value)\r\n    })\r\n}\r\n</script>\r\n\r\n<style lang='stylus'>\r\n@import '~src/style/palette'\r\n\r\n.create-report\r\n\r\n    .bold-text\r\n        font-size 18px\r\n        font-weight 500\r\n        margin 4px 0\r\n\r\n    .datepicker-placeholder\r\n        display inline-block\r\n        margin-right 8px\r\n\r\n    .record-datepicker\r\n        border 1px solid $light-gray\r\n        border-radius 3px\r\n        font-size 18px\r\n        padding 6px 12px\r\n        margin-right 12px\r\n\r\n    .blocks-div\r\n        align-items flex-start\r\n        display flex\r\n        justify-content space-between\r\n        margin 24px 0\r\n\r\n        .block\r\n            width calc(50% - 10px)\r\n\r\n        .options-div\r\n            border 1px solid $light-gray\r\n            border-radius 5px\r\n            margin-bottom 12px\r\n            padding 16px\r\n\r\n        .bold-text-div\r\n            align-items flex-end\r\n            display flex\r\n            justify-content space-between\r\n            height 40px\r\n            margin-bottom 8px\r\n\r\n        .search\r\n            border 1px solid lighten($light-gray, 10)\r\n            border-radius 3px\r\n            font-size 18px\r\n            outline none\r\n            padding 8px 12px\r\n            width 320px\r\n            &:focus\r\n                border-color darken($light-gray, 10)\r\n\r\n        .not-found\r\n            color darken($light-gray, 20)\r\n\r\n</style>"]}]}