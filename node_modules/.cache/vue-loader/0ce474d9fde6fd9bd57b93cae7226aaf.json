{"remainingRequest":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\views\\Users.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\source\\views\\Users.vue","mtime":1576385937160},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Turar\\Projects\\Work\\studdom\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCdXR0b24gZnJvbSAnOnNyYy9jb21wb25lbnRzL1VJL0J1dHRvbi52dWUnCgpleHBvcnQgZGVmYXVsdCB7CiAgICBjb21wb25lbnRzOiB7IEJ1dHRvbiB9LAogICAgY29tcHV0ZWQ6IHsgbGlzdCwgc29ydGVkLCBhbGwgfSwKICAgIG1ldGhvZHM6IHsgZ2V0TGV2ZWwsIG9wZW5Nb2RhbCB9LAogICAgbW91bnRlZDogc3RhcnQsCiAgICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgc2VhcmNoOiAnJywKICAgICAgICAgICAgdXNlcnM6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIubGlzdCwKICAgICAgICAgICAgY2FuQ3JlYXRlOiB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmRhdGEudHlwZSA9PT0gJ2FkbWluJwogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gbGlzdCAoKSB7CiAgICB2YXIgbGlzdCA9IFtdCgogICAgdGhpcy4kc3RvcmUuc3RhdGUudXNlci5saXN0LmZvckVhY2godXNlciA9PiB7CiAgICAgICAgbGV0IHB1c2ggPSBKU09OLnBhcnNlKCBKU09OLnN0cmluZ2lmeSh1c2VyKSApCgogICAgICAgIHB1c2guZnVsbE5hbWUgPSBgJHt1c2VyLmxhc3ROYW1lfSAke3VzZXIuZmlyc3ROYW1lfSAke3VzZXIucGF0cm9ueW1pY31gCiAgICAgICAgbGlzdC5wdXNoKHB1c2gpCiAgICB9KQoKICAgIHJldHVybiBsaXN0Cn0KCmZ1bmN0aW9uIHNvcnRlZCAoKSB7CiAgICB2YXIgbGlzdCA9IFtdCgogICAgaWYgKCB0aGlzLmxpc3QgIT0gdW5kZWZpbmVkICkKICAgICAgICB0aGlzLmxpc3QuZm9yRWFjaCgodXNlcikgPT4gewogICAgICAgICAgICBpZiAoIHVzZXIuZnVsbE5hbWUudG9Mb3dlckNhc2UoKS5zZWFyY2goIHRoaXMuc2VhcmNoLnRvTG93ZXJDYXNlKCkgfHwgJycgKSA+IC0xICkKICAgICAgICAgICAgICAgIGxpc3QucHVzaCh1c2VyKQogICAgICAgIH0pCgogICAgcmV0dXJuIGxpc3QKfQoKZnVuY3Rpb24gYWxsICgpIHsKICAgIHZhciBjb3VudCA9IDAKCiAgICBpZiAoIHRoaXMuc29ydGVkICE9IHVuZGVmaW5lZCApCiAgICAgICAgdGhpcy5zb3J0ZWQuZm9yRWFjaCh1c2VyID0+IHsKICAgICAgICAgICAgY291bnQgKz0gdXNlci5zaWducyB8fCAwCiAgICAgICAgfSkKCiAgICByZXR1cm4gY291bnQKfQoKZnVuY3Rpb24gZ2V0TGV2ZWwgKHR5cGUpIHsKICAgIGlmICggdHlwZSA9PT0gJ2FkbWluJyApCiAgICAgICAgcmV0dXJuICfQkNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgCcKCiAgICBlbHNlIHJldHVybiAn0KPQv9GA0LDQstC70Y/RjtGJ0LjQuScKfQoKZnVuY3Rpb24gb3Blbk1vZGFsIChpc05ldywgdXNlcikgewogICAgaWYgKCBpc05ldyA9PT0gdHJ1ZSApIHsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ29wZW5Nb2RhbCcsIHsKICAgICAgICAgICAgbmFtZTogJ2NyZWF0ZVVzZXInLAogICAgICAgICAgICBkYXRhOiB7fQogICAgICAgIH0pCiAgICB9CgogICAgZWxzZSB7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdvcGVuTW9kYWwnLCB7CiAgICAgICAgICAgIG5hbWU6ICdlZGl0VXNlcicsCiAgICAgICAgICAgIGRhdGE6IHVzZXIKICAgICAgICB9KQogICAgfQp9CgpmdW5jdGlvbiBlZGl0VXNlciAoaWQpIHsKICAgIHZhciB1c2VyID0gdGhpcy51c2Vyc1tpZF0KICAgIHZhciBuYW1lID0gdXNlclswXS5zcGxpdCgwKQoKICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnb3Blbk1vZGFsJywgewogICAgICAgIG5hbWU6ICdjcmVhdGVVc2VyJywKICAgICAgICBkYXRhOiB7IGlkIH0KICAgIH0pCn0KCmFzeW5jIGZ1bmN0aW9uIHN0YXJ0ICgpIHsKICAgIHZhciB7IGRhdGEgfSA9IGF3YWl0IHRoaXMuYXBpLmdldCgndXNlci9saXN0JykKICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgndXNlcnMtbGlzdC1zZXQnLCBkYXRhKQp9Cg=="},{"version":3,"sources":["Users.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Users.vue","sourceRoot":"source/views","sourcesContent":["<template lang=\"pug\">\n\ndiv#students\n\n    div( class='controls-div' )\n            Button( v-if='canCreate' icon='plus' title='Создать пользователя' background='blue' icon-top='2px' @click.native='openModal(true)' )\n            span( v-else )\n            input( class='user-search' placeholder='Поиск по имени...' v-model='search' )\n\n    table( class='all-dormitories' )\n        thead( class='not-body head' )\n            tr( class='row' )\n                th( class='data' ) Полное имя\n                th( class='data' ) Должность\n                th( class='data' ) Уровень доступа\n                th( class='data' ) Посещений\n            \n        tbody( class='body' )\n            tr( v-for='(user, id) in sorted' class='row' :key='id' @click='openModal(false, user)' )\n                td( class='data' ) {{ user.fullName }}\n                td( class='data' ) {{ user.position }}\n                td( class='data' ) {{ getLevel(user.type) }}\n                td( class='data' ) {{ user.signs }}\n\n        tfoot( class='not-body foot' )\n            tr( class='row' )\n                th( class='data' colspan='3' ) Всего\n                td( class='data' ) {{ all }}\n</template>\n\n<script>\nimport Button from ':src/components/UI/Button.vue'\n\nexport default {\n    components: { Button },\n    computed: { list, sorted, all },\n    methods: { getLevel, openModal },\n    mounted: start,\n    data: function () {\n        return {\n            search: '',\n            users: this.$store.state.user.list,\n            canCreate: this.$store.state.user.data.type === 'admin'\n        }\n    }\n}\n\nfunction list () {\n    var list = []\n\n    this.$store.state.user.list.forEach(user => {\n        let push = JSON.parse( JSON.stringify(user) )\n\n        push.fullName = `${user.lastName} ${user.firstName} ${user.patronymic}`\n        list.push(push)\n    })\n\n    return list\n}\n\nfunction sorted () {\n    var list = []\n\n    if ( this.list != undefined )\n        this.list.forEach((user) => {\n            if ( user.fullName.toLowerCase().search( this.search.toLowerCase() || '' ) > -1 )\n                list.push(user)\n        })\n\n    return list\n}\n\nfunction all () {\n    var count = 0\n\n    if ( this.sorted != undefined )\n        this.sorted.forEach(user => {\n            count += user.signs || 0\n        })\n\n    return count\n}\n\nfunction getLevel (type) {\n    if ( type === 'admin' )\n        return 'Администратор'\n\n    else return 'Управляющий'\n}\n\nfunction openModal (isNew, user) {\n    if ( isNew === true ) {\n        this.$store.commit('openModal', {\n            name: 'createUser',\n            data: {}\n        })\n    }\n\n    else {\n        this.$store.commit('openModal', {\n            name: 'editUser',\n            data: user\n        })\n    }\n}\n\nfunction editUser (id) {\n    var user = this.users[id]\n    var name = user[0].split(0)\n\n    this.$store.commit('openModal', {\n        name: 'createUser',\n        data: { id }\n    })\n}\n\nasync function start () {\n    var { data } = await this.api.get('user/list')\n    this.$store.commit('users-list-set', data)\n}\n</script>\n\n<style lang='stylus'>\n@import '~src/style/palette'\n\n#students\n\n    .controls-div \n        align-items center\n        display flex\n        justify-content space-between\n\n        .user-search\n            border 1px solid lighten($light-gray, 10)\n            border-radius 3px\n            font-size 18px\n            outline none\n            padding 10px 14px\n            width 320px\n            &:focus\n                border-color darken($light-gray, 10)\n\n    .all-dormitories\n        border-collapse collapse\n        margin 42px 0\n        width 100%\n\n        .not-body\n            &.head\n                border-bottom 1px solid $light-gray\n            &.foot\n                border-top 1px solid $light-gray\n\n                .data\n                    padding-top 4px\n\n            .data\n                font-weight 500\n                padding 8px 12px\n\n        .body\n            &:before, &:after\n                content ''\n                display block\n                height 8px\n\n            .data:last-child\n                font-weight 500\n\n            .row\n                cursor pointer\n                &:hover\n                    background lighten($light-gray, 25)\n\n        .data\n            font-size 24px   \n            padding 4px 12px\n            text-align left\n            &:last-child\n                text-align right\n</style>"]}]}